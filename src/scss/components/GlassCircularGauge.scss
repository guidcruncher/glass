// Import user-provided SCSS files
@use '../config' as *;
@use '../mixins' as *;
@use '../_glass-theme.mixin' as *;

// --- GAUGE THEME MIXIN ---
// Contains the logic to apply colors and the glass effect for a specific theme
@mixin apply-gauge-styles($theme) {
  // 1. Apply the core glassmorphism to the container/wrapper
  // We use 'bg-panel' as the background color property
  @include apply-glass-theme($theme, $bg-prop: bg-panel);

  // 2. Retrieve specific theme colors for the SVG elements
  $ui-text-color: theme-prop($theme, ui-text-color);
  $track-color: theme-prop($theme, ui-border-color);
  $progress-color: theme-prop($theme, ui-primary-button-bg);

  .gauge-track {
    stroke: $track-color;
  }

  .gauge-progress {
    stroke: $progress-color;
  }

  .gauge-value-text {
    fill: $ui-text-color;
  }
}

// --- BASE STYLES & THEME SWITCHING ---
.circular-gauge {
  position: relative;
  border-radius: $glass-border-radius;
  overflow: hidden;
  padding: 10px;
  box-sizing: border-box;

  .gauge-svg {
    display: block;
    margin: auto;
  }

  .gauge-track,
  .gauge-progress {
    fill: none;
    stroke-width: 8;
    transform-origin: 50% 50%;
    // Rotate to start the progress at the top (12 o'clock)
    transform: rotate(-90deg);
    transition:
      stroke-dasharray 0.5s ease-out,
      stroke 0.3s ease-in-out;
  }

  .gauge-value-text {
    font-weight: bold;
    transition: fill 0.3s ease-in-out;
  }

  // --- 1. LIGHT THEME (DEFAULT) ---
  // Apply the light theme styles by default.
  @include apply-gauge-styles(light);

  // --- 2. DARK THEME OVERRIDE ---
  // Use the .dark-mode class on an ancestor element (e.g., body or app wrapper)
  // to switch the gauge to the dark theme.
  .dark-mode & {
    @include apply-gauge-styles(dark);
  }

  // --- SIZE-SPECIFIC STYLES ---
  &.gauge--sm .gauge-value-text {
    font-size: 16px;
  }
  &.gauge--md .gauge-value-text {
    font-size: 20px;
  }
  &.gauge--lg .gauge-value-text {
    font-size: 28px;
  }
  &.gauge--xl .gauge-value-text {
    font-size: 36px;
  }
}
